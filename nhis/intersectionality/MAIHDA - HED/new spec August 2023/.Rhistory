library(tidyverse)
library(readr)
library(tidyr)
library(dplyr)
library(labelled)
library(haven)
library(ggplot2)
library(forcats)
## Bias toward non-scientific notation
options(scipen=10)
# Set default theme for plots:
theme_set(theme_bw(base_size = 12))
##### Plots for full sample
# Read in data
plot_data_full_sample <- readRDS("C:/Users/cmp21seb/Documents/SIMAH/SIMAH_workplace/nhis/intersectionality/results tables/new spec August 2023/mdata_results.rds")
# Prep data for plotting
plot_data_full_sample <- plot_data_full_sample %>%
mutate(sex=ifelse(grepl("Female",intersectional_names),"Female","Male"),
race=ifelse(grepl("Asian",intersectional_names),"Asian",
ifelse(grepl("Black", intersectional_names),"Black",
ifelse(grepl("AI/AN", intersectional_names), "AI/AN",
ifelse(grepl("Multiple race", intersectional_names), "Multiple race",
ifelse(grepl("Hispanic White", intersectional_names), "Hispanic White","White"))))),
race=factor(race, levels=c("Asian","Black", "Hispanic White", "AI/AN", "Multiple race", "White")),
education=ifelse(grepl("high school", intersectional_names), "low edu.",
ifelse(grepl("some college", intersectional_names), "medium edu.", "high edu.")),
education=factor(education,levels=c("low edu.", "medium edu.", "high edu.")),
age=ifelse(grepl("18-24", intersectional_names), "18-24",
ifelse(grepl("25-69", intersectional_names), "25-69", "70+")))
# Plots of predicted % of HEDs - seperate for males and females
male_HED_probability <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race, y=pmn)) +
geom_point(position=position_dodge(width=0.8)) +
geom_errorbar(aes(ymin = plo,
ymax = phi),
position=position_dodge(width=0.8)) +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=45),
legend.position = "bottom") +
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs")
male_HED_probability
ggsave("C:/Users/cmp21seb/Documents/SIMAH/SIMAH_workplace/nhis/intersectionality/plots/new spec August 2023/estimated_HEDs_males.png", dpi=300, width=33, height=19, units="cm")
# Plot females
female_HED_probability <- plot_data_full_sample %>%
filter(sex=="Female") %>%
ggplot(aes(x=race, y=pmn)) +
geom_point(position=position_dodge(width=0.8)) +
geom_errorbar(aes(ymin = plo,
ymax = phi),
position=position_dodge(width=0.8)) +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=45),
legend.position = "bottom") +
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs")
female_HED_probability
ggsave("C:/Users/cmp21seb/Documents/SIMAH/SIMAH_workplace/nhis/intersectionality/plots/new spec August 2023/estimated_HEDs_females.png", dpi=300, width=33, height=19, units="cm")
# Plot females
female_HED_probability <- plot_data_full_sample %>%
filter(sex=="Female") %>%
ggplot(aes(x=race, y=pmn)) +
geom_point(position=position_dodge(width=0.8)) +
geom_errorbar(aes(ymin = plo,
ymax = phi),
position=position_dodge(width=0.8)) +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=45),
legend.position = "bottom") +
ggtitle("Women")+
labs(y= "Estimated percentage of HEDs")
female_HED_probability
ggsave("C:/Users/cmp21seb/Documents/SIMAH/SIMAH_workplace/nhis/intersectionality/plots/new spec August 2023/estimated_HEDs_females.png", dpi=300, width=33, height=19, units="cm")
# Plots of predicted % of HEDs - seperate for males and females
male_HED_probability <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race, y=pmn)) +
geom_point(position=position_dodge(width=0.8)) +
geom_errorbar(aes(ymin = plo,
ymax = phi),
position=position_dodge(width=0.8)) +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90),
legend.position = "bottom") +
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs")
male_HED_probability
ggsave("C:/Users/cmp21seb/Documents/SIMAH/SIMAH_workplace/nhis/intersectionality/plots/new spec August 2023/estimated_HEDs_males.png", dpi=300, width=33, height=19, units="cm")
# Plot females
female_HED_probability <- plot_data_full_sample %>%
filter(sex=="Female") %>%
ggplot(aes(x=race, y=pmn)) +
geom_point(position=position_dodge(width=0.8)) +
geom_errorbar(aes(ymin = plo,
ymax = phi),
position=position_dodge(width=0.8)) +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90),
legend.position = "bottom") +
ggtitle("Women")+
labs(y= "Estimated percentage of HEDs")
female_HED_probability
ggsave("C:/Users/cmp21seb/Documents/SIMAH/SIMAH_workplace/nhis/intersectionality/plots/new spec August 2023/estimated_HEDs_females.png", dpi=300, width=33, height=19, units="cm")
plot_data_drinkers <- readRDS("C:/Users/cmp21seb/Documents/SIMAH/SIMAH_workplace/nhis/intersectionality/results tables/new spec August 2023/mdata_results_drinkers.rds")
# Plots of predicted % of HEDs - seperate for males and females
male_HED_probability_drinkers <- plot_data_drinkers %>%
filter(sex=="Male") %>%
ggplot(aes(x=race, y=pmn)) +
geom_point(position=position_dodge(width=0.8)) +
geom_errorbar(aes(ymin = plo,
ymax = phi),
position=position_dodge(width=0.8)) +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90),
legend.position = "bottom") +
ggtitle("Men - drinkers only")+
labs(y= "Estimated percentage of HEDs")
# Prep data for plotting
plot_data_drinkers <- plot_data_drinkers %>%
mutate(sex=ifelse(grepl("Female",intersectional_names),"Female","Male"),
race=ifelse(grepl("Asian",intersectional_names),"Asian",
ifelse(grepl("Black", intersectional_names),"Black",
ifelse(grepl("AI/AN", intersectional_names), "AI/AN",
ifelse(grepl("Multiple race", intersectional_names), "Multiple race",
ifelse(grepl("Hispanic White", intersectional_names), "Hispanic White","White"))))),
race=factor(race, levels=c("Asian","Black", "Hispanic White", "AI/AN", "Multiple race", "White")),
education=ifelse(grepl("high school", intersectional_names), "low edu.",
ifelse(grepl("some college", intersectional_names), "medium edu.", "high edu.")),
education=factor(education,levels=c("low edu.", "medium edu.", "high edu.")),
age=ifelse(grepl("18-24", intersectional_names), "18-24",
ifelse(grepl("25-69", intersectional_names), "25-69", "70+")))
# Plots of predicted % of HEDs - seperate for males and females
male_HED_probability_drinkers <- plot_data_drinkers %>%
filter(sex=="Male") %>%
ggplot(aes(x=race, y=pmn)) +
geom_point(position=position_dodge(width=0.8)) +
geom_errorbar(aes(ymin = plo,
ymax = phi),
position=position_dodge(width=0.8)) +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90),
legend.position = "bottom") +
ggtitle("Men - drinkers only")+
labs(y= "Estimated percentage of HEDs")
male_HED_probability_drinkers
ggsave("C:/Users/cmp21seb/Documents/SIMAH/SIMAH_workplace/nhis/intersectionality/plots/new spec August 2023/estimated_HEDs_males_drinkers.png", dpi=300, width=33, height=19, units="cm")
# Plot females
female_HED_probability_drinkers <- plot_data_drinkers %>%
filter(sex=="Female") %>%
ggplot(aes(x=race, y=pmn)) +
geom_point(position=position_dodge(width=0.8)) +
geom_errorbar(aes(ymin = plo,
ymax = phi),
position=position_dodge(width=0.8)) +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90),
legend.position = "bottom") +
ggtitle("Women - drinkers only")+
labs(y= "Estimated percentage of HEDs")
female_HED_probability_drinkers
ggsave("C:/Users/cmp21seb/Documents/SIMAH/SIMAH_workplace/nhis/intersectionality/plots/new spec August 2023/estimated_HEDs_females_drinkers.png", dpi=300, width=33, height=19, units="cm")
# Plots of additive only versus total estimates
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(y=pmn, position=position_dodge(width=0.8)) +
geom_errorbar(aes(ymin = plo,
ymax = phi),
position=position_dodge(width=0.8)) +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90),
legend.position = "bottom") +
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs")
View(plot_data_full_sample)
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race, y=pmn)) +
geom_point(position=position_dodge(width=0.8)) +
geom_errorbar(aes(ymin = pmn,
ymax = pAmn),
position=position_dodge(width=0.8)) +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90),
legend.position = "bottom") +
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs")
male_HED_add_vs_mul
# Plots of additive only versus total estimates
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pmn)) +
geom_point(aes(y=pAmn)) +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90),
legend.position = "bottom") +
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs")
male_HED_add_vs_mul
# Plots of additive only versus total estimates
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pmn), colour = "lawngreen") +
geom_point(aes(y=pAmn), colour = "blue") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90),
legend.position = "bottom") +
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs")
male_HED_add_vs_mul
# Plots of additive only versus total estimates
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pmn), colour = "darkgreen") +
geom_point(aes(y=pAmn), colour = "lawngreen") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90),
legend.position = "bottom") +
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs")
male_HED_add_vs_mul
# Plots of additive only versus total estimates
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pmn), colour = "darkgreen") +
geom_point(aes(y=pAmn), colour = "lightgreen") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90),
legend.position = "bottom") +
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs")
male_HED_add_vs_mul
# Plots of additive only versus total estimates
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pmn), colour = "darkgreen") +
geom_point(aes(y=pAmn), colour = "lightgreen") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90))+
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs")
male_HED_add_vs_mul
# Plots of additive only versus total estimates
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pmn), colour = "darkgreen") +
geom_point(aes(y=pAmn), colour = "yellow") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90))+
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs")
male_HED_add_vs_mul
# Plots of additive only versus total estimates
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pmn), colour = "darkgreen") +
geom_point(aes(y=pAmn), colour = "lightyellow") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90))+
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs")
male_HED_add_vs_mul
# Plots of additive only versus total estimates
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pAmn), colour = "lightyellow") +
geom_point(aes(y=pmn), colour = "darkgreen") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90))+
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs")
male_HED_add_vs_mul
# Plots of additive only versus total estimates
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pAmn), colour = "lightgreen") +
geom_point(aes(y=pmn), colour = "darkgreen") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90))+
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs")
male_HED_add_vs_mul
# Plots of additive only versus total estimates
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pAmn), colour = "lightgreen") +
geom_point(aes(y=pmn), colour = "darkgreen") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90))+
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs") +
labs(caption = "Light green: estimate based on additive effects only.  Dark green: estimate based on additive and interaction effects")
male_HED_add_vs_mul
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pAmn), colour = "lightgreen") +
geom_point(aes(y=pmn), colour = "darkgreen") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90))+
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs") +
labs(caption = "Estimate based on additive effects only", colour="lightgreen") +
labs(caption = "Estimate based on additive & interaction effects", colour="darkgreen") +
male_HED_add_vs_mul
# Plots of additive only versus total estimates
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pAmn), colour = "lightgreen") +
geom_point(aes(y=pmn), colour = "darkgreen") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90))+
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs") +
labs(caption = "Estimate based on additive effects only", colour="lightgreen") +
labs(caption = "Estimate based on additive & interaction effects", colour="darkgreen")
male_HED_add_vs_mul
# Plots of additive only versus total estimates
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pAmn), colour = "lightgreen") +
geom_point(aes(y=pmn), colour = "darkgreen") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90))+
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs") +
labs(caption = "Light green: estimate based on additive effects only.
Dark green: Estimate based on additive & interaction effects")
male_HED_add_vs_mul
male_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pAmn), colour = "lightgreen") +
geom_point(aes(y=pmn), colour = "darkgreen") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90))+
ggtitle("Men")+
labs(y= "Estimated percentage of HEDs") +
labs(caption = "Light green: estimate based on additive effects only
Dark green: Estimate based on additive & interaction effects")
male_HED_add_vs_mul
ggsave("C:/Users/cmp21seb/Documents/SIMAH/SIMAH_workplace/nhis/intersectionality/plots/new spec August 2023/estimated_HEDs_males_add_vs_mult.png", dpi=300, width=33, height=19, units="cm")
# Plots of additive only versus total estimates
female_HED_add_vs_mul <- plot_data_full_sample %>%
filter(sex=="Female") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pAmn), colour = "lightgreen") +
geom_point(aes(y=pmn), colour = "darkgreen") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90))+
ggtitle("Women")+
labs(y= "Estimated percentage of HEDs") +
labs(caption = "Light green: estimate based on additive effects only
Dark green: Estimate based on additive & interaction effects")
female_HED_add_vs_mul
ggsave("C:/Users/cmp21seb/Documents/SIMAH/SIMAH_workplace/nhis/intersectionality/plots/new spec August 2023/estimated_HEDs_females_add_vs_mult.png", dpi=300, width=33, height=19, units="cm")
male_HED_add_vs_mul_drinkers <- plot_data_drinkers %>%
filter(sex=="Male") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pAmn), colour = "lightgreen") +
geom_point(aes(y=pmn), colour = "darkgreen") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90))+
ggtitle("Men - drinkers only")+
labs(y= "Estimated percentage of HEDs") +
labs(caption = "Light green: estimate based on additive effects only
Dark green: Estimate based on additive & interaction effects")
male_HED_add_vs_mul_drinkers
ggsave("C:/Users/cmp21seb/Documents/SIMAH/SIMAH_workplace/nhis/intersectionality/plots/new spec August 2023/estimated_HEDs_males_add_vs_mult_drinkers.png", dpi=300, width=33, height=19, units="cm")
# Plots of additive only versus total estimates
female_HED_add_vs_mul_drinkers <- plot_data_drinkers %>%
filter(sex=="Female") %>%
ggplot(aes(x=race)) +
geom_point(aes(y=pAmn), colour = "lightgreen") +
geom_point(aes(y=pmn), colour = "darkgreen") +
ylim(0, 100) +
facet_grid(cols=vars(education),rows=vars(age)) +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle=90))+
ggtitle("Women - drinkers only")+
labs(y= "Estimated percentage of HEDs") +
labs(caption = "Light green: estimate based on additive effects only
Dark green: Estimate based on additive & interaction effects")
female_HED_add_vs_mul_drinkers
ggsave("C:/Users/cmp21seb/Documents/SIMAH/SIMAH_workplace/nhis/intersectionality/plots/new spec August 2023/estimated_HEDs_females_add_vs_mult_drinkers.png", dpi=300, width=33, height=19, units="cm")
